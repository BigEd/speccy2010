#summary FAQ.

Speccy2010. Часто задаваемые вопросы.

1.Мне досталась пустая плата Speccy2010, что делать дальше?
Нужно собрать комплектующие и выполнить монтаж. Файл Speccy2010_r1.bom.pdf содержит перечень элементов, файл Speccy2010_r1.pcb.pdf — их расположение на плате. Возможно понадобиться схема, она в файле Speccy2010_r1.sch.pdf.
2.А почему в перечне не все элементы, которые есть в схеме?
Часть элементов не нужно устанавливать в базовой версии. Их в перечне нет. Также на печатной плате некоторые элементы продублированы в разных корпусах, чтобы была возможность ставить элемент в доступном корпусе.
3.У меня плата первой ревизии, что делать?
Плата первой ревизии содержит две ошибки, которые нужно исправить, для нормальной работы компьютера.
1. На TDA1543 ошибочно заведено питание 3.3 вольта - нужно было завести 5.0 В. Для исправления нужно порезать дорожку идущую к 5 ноге TDA1543 (обозначена красным цветом) и кинуть на нее проводом 5 В (обозначен желтым цветом).
Если используется микросхема в DIP8 корпусе, то патч выглядит так:
Если используется микросхема в SO16 корпусе, то патч выглядит так:

2. Генератор 20 МГц собранный на одном инверторе 74HCU04 работает не стабильно. Это проявляется в дрожании строк и периодических ошибках при работе с sdram. Для исправления нужно вставить еще хотя бы один инвертор (их там еще 5 штук свободны) между генератором и тактовым входом плис. Один из вариантов модификации на рисунках:
- режем дорожку обозначенную красным цветом
- поднимаем ноги 11, 13 DD8 (обозначены красными точками) в воздух
- резистор R140 поворачиваем на 90 градусов
- бросаем 3 проводка обозначенных желтым цветом (2 проводка идут к ножкам, которые висят в воздухе)


4.Я уже имею собранную плату, что нужно еще?
Необходимый минимум:
- источник питания 5В, 1А;
- SD флеш-карта (FAT16, FAT32);
- кабель для подключения к телевизору;
- клавиатура PS/2;
- USB кабель для программирования микроконтроллера;
5.Столько разъемов на плате. Куда что подключать?
XS10 – питание 5В, земля снаружи;
XS1 — USB кабель для программирования микроконтроллера и отладки;
XS6 — аудиовыход;
XS8 — видеовыход S-Video;
XS9 — VGA выход, также используется как выход на телевизор в режиме RGB;
XS7 — видеовыход Composite;
XS2 — вход клавиатуры PS/2;
XS5 — вход мышки PS/2;
XS4 – слот для SD карточки;
XP2 – вход джойстика 1;
XPЗ – вход джойстика 2.
6.Как выглядит кабель для подключения Speccy2010 к телевизору к разъему SCART используя RGB  выход?
VGA разъем
SCART разъем
Назначение
1
15
R
2
11
G
3
7
B
6
13
R GND
7
9
G GND
8
5
B GND
13
20
PAL SYNC
14
16
RGB SWITCH
5
8
GND (TV/AV)
10
17,18
GND
Если проводов не хватает, можно все земли объеденить.
Нумерация выводов на разъеме VGA (кабельная часть - папа).
Нумерация выводов на разъеме SCART (кабельная часть — папа).


7.Как выглядит кабель для подключения Speccy2010 к телевизору к разъему SCART используя S-Video выход?
S-Video разъем
SCART разъем
Назначение
1
17
GND Y
2
13
GND C
3
20
Y
4
15
C
1,2
16
GND (RGB SWITCH)
1,2
8
GND (TV/AV)
1,2
18
GND

Нумерация выводов на разъеме S-Video.


8.Как вывести на SCART звук?
Audio разъем
SCART разъем
Назначение
1
4
GND
2
2
RIGHT
3
6
LEFT

Нумерация выводов на разъеме TRS.

9.А как выглядит вход джойстика?
Подойдет джойстик от Atari и SEGA с 9-пиновым разъемом (мама). Назначение пинов:
DB9
Назначение
1
UP
2
DOWN
3
LEFT
4
RIGHT
5
+5V
6
BUTTON A/B
7
SELECT
8
GND
9
BUTTON START/C

Нумерация выводов на разъеме DB9 female.

10.Я все подключил, что дальше?
Первым делом прошиваем  микроконтроллер. Для этого нужно:
- скачать драйвера VCP для микросхемы FT232RL (http://www.ftdichip.com/Drivers/VCP.htm), и установить их;
- подключить плату USB кабелем к компьютеру (к разъему XS1), подождать пока появится новый COM порт;
- замкнуть перемычку XP7, потом подать напряжение на плату — замыкание перемычки XP10;
- запустить утилиту для программирования микроконтроллера (утилита лежит тут http://code.google.com/p/speccy2010/downloads/list), командная строка должна выглядеть так: «str750prog.exe --port COM2 --write speccy2010.bin». Номер порта поставить свой. 
- выключить питание (XP10), убрать перемычку XP7.
- Speccy2010 готов к первому запуску.
11.Как прошить ПЛИС?
ПЛИС прошивать не нужно, просто скопируйте файл прошивки speccy2010.rbf в корневой каталог карточки. Во время запуска прошивка с карточки загрузиться в ПЛИС.
12.Что еще записать на карточку?
Еще нужны образы ПЗУ в директории roms (48.rom – 16kB, pentagon.rom — 32kB, trdos.rom – 16kB ). И много ваших любимых игр и программ.
13.Какие форматы понимает компьютер?
Tap, tzx, sna, trd, fdi, scl, scr.
14.Как включить компьютер?
Замкнуть перемычку  XS10, карточка должна быть вставлена, перемычка XS7 снята. Загрузка занимает несколько секунд.
15.Несколько секунд прошло, но картинка не появилась, что делать?
Возможно нужно переключить режим видеовыхода.
Ctrl+1 – включает режим PAL Composite/S-Video;
Ctrl+2 – включает режим PAL RGB;
Выбранный режим сохраниться в настройках и при следующем запуске включится автоматически.
16.Картинка появилась, но звука нет, что делать?
Заходим в шел (F12), потом в меню настроек (F12), устанавливаем правильное значение в пункте «Audio DAC mode». Скорее всего там должно стоять «TDA1543». Там же обращаем внимание на все остальные настройки. Выход из меню настоек и из шела — ESC.
17.А как запустить игру?
Если это образ ленты в формате tap, tzx — заходим в шел (F12), нажимаем ENTER на нужном файле, выходим из шела (ESC). Набираем LOAD “”. Жмем ENTER. Включаем магнитофон клавишей «+». Для остановки ленты используем клавишу «-».
Если это дамп ОЗУ в формате sna — заходим в шел (F12), нажимаем ENTER на нужном файле – дамп загрузится и запустится.
Если это образ диска в формате trd, fdi, scl — заходим в шел (F12), нажимаем ENTER на нужном файле – образ смонтируется на диск A и автоматически запустится TRDOS. Если нужно смонтировать образ без перегрузки, то это делается нажатием клавиши «1» - «4» (диски A – D соответственно) на выбранном файле в шеле.
18.Хочу наблюдать построчную загрузку картинки в игре, что делать.
Жать F2 между блоками загрузки программы, это сбросит атрибуты экрана на значение «черный на белом».
19.А что делает клавиша F1?
Задерживает выполнение программы ровно на 1 такт. Это для просмотра демок, где все такты посчитаны.
20.Я все время умираю и приходится играть с начала, что делать?
Для этого предусмотрена функция сохранения дампа ОЗУ в формате sna, который потом в любое время можно загрузить, и продолжить играть с любимого места. Делается это клавишей F11. Дамп сохраняется в директорию, активную в данный момент в шеле. В дамп сохраняются все 8 страниц ОЗУ и все регистры, при этом ни стек, ни экранная область не портится.
21.Есть еще какие-то клавиши задействованные?
L.Ctrl+R.Ctrl (или Power) – Reset;
L.Ctrl, Up, Down, Left, Right – эмуляция джойстика (какой именно джойстик эмулируется выбираем в настройках);
Pg.Up, Pg.Down, Home, End – эмуляция курсорных клавиш.
22.А что еще можно делать в шеле?
Только смотреть картинки в формате scr. Функции полноценной работы с файловой системой еще не реализованы (копирование, удаление, перемещение файлов).
23.А что выход на VGA монитор не работает?
Да, это еще не реализовано.
24.Времянки режима фирменного спектрума не правильные.
Да, пока реализован только режим пентагона.
25.Какие варианты памяти реализованы?
Классический 48k, классический 128k, пентагон 1024k.
26.А где взять свежие прошивки?
http://zx.pk.ru/showthread.php?t=12425
http://code.google.com/p/speccy2010/
27.А исходники прошивок доступны?
Да. Исходники можно скачать так: 
svn checkout http://speccy2010.googlecode.com/svn/trunk/ speccy2010-read-only
28.Как компилировать прошивки?
Для компиляции прошивки ПЛИС нужен Quartus. Я использую Quartus 9.1.
Прошивка для микроконтроллера компилируется opensource компилятором GCC. Я использую бесплатную Lite сборку от CodeSourcery (http://www.codesourcery.com/sgpp/lite/arm, EABI версия) под Windows в связке с лучшей opensource средой для разработки на C/C++ - code::blocks (http://www.codeblocks.org/).
29.Я хочу что-то поменять/дописать в прошивке, что делать?
Скачать исходники и менять/дописывать.
30.Я хочу поучаствовать в проекте.
Пишите мне, что-то придумаем.